{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport http from \"@/api/http\";\nexport default {\n  name: \"LoginView\",\n  data() {\n    return {\n      username: \"\",\n      password: \"\",\n      errorMessage: \"\",\n      loading: false,\n      showPass: false\n    };\n  },\n  mounted() {\n    // Si ya hay token, redirige a la app\n    const token = localStorage.getItem(\"access_token\");\n    if (token) this.$router.replace(\"/categorias\");\n  },\n  methods: {\n    async handleLogin() {\n      this.errorMessage = \"\";\n      if (!this.username || !this.password) {\n        this.errorMessage = \"Ingrese usuario y contraseña\";\n        return;\n      }\n      this.loading = true;\n      try {\n        // /auth/login devuelve access en JSON y setea refresh en cookie HTTPOnly\n        const {\n          data\n        } = await http.post(\"/auth/login\", {\n          username: this.username,\n          password: this.password\n        });\n\n        // Guardar access token y (opcional) username para mostrar en navbar\n        localStorage.setItem(\"access_token\", data.access_token);\n        if (data?.user?.username) localStorage.setItem(\"username\", data.user.username);\n\n        // Ir al dashboard (ajusta la ruta si necesitas)\n        this.$router.push(\"/categorias\");\n      } catch (e) {\n        this.errorMessage = e?.response?.data?.error || \"Usuario o contraseña incorrectos\";\n      } finally {\n        this.loading = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["http","name","data","username","password","errorMessage","loading","showPass","mounted","token","localStorage","getItem","$router","replace","methods","handleLogin","post","setItem","access_token","user","push","e","response","error"],"sources":["C:\\Users\\pedvi\\Documents\\catalogo-web\\frontend\\src\\views\\LoginView.vue"],"sourcesContent":["<template>\r\n  <div class=\"container d-flex justify-content-center align-items-center\" style=\"min-height: 70vh;\">\r\n    <div class=\"card shadow-sm\" style=\"max-width: 420px; width: 100%;\">\r\n      <div class=\"card-body p-4\">\r\n        <h3 class=\"mb-3 text-center\">Iniciar sesión</h3>\r\n        <form @submit.prevent=\"handleLogin\" novalidate>\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">Usuario</label>\r\n            <input\r\n              v-model.trim=\"username\"\r\n              type=\"text\"\r\n              class=\"form-control\"\r\n              autocomplete=\"username\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">Contraseña</label>\r\n            <div class=\"input-group\">\r\n              <input\r\n                :type=\"showPass ? 'text' : 'password'\"\r\n                v-model=\"password\"\r\n                class=\"form-control\"\r\n                autocomplete=\"current-password\"\r\n                required\r\n              />\r\n              <button\r\n                class=\"btn btn-outline-secondary\"\r\n                type=\"button\"\r\n                @click=\"showPass = !showPass\"\r\n                :disabled=\"loading\"\r\n                title=\"Mostrar/Ocultar\"\r\n              >\r\n                {{ showPass ? 'Ocultar' : 'Mostrar' }}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <button :disabled=\"loading\" type=\"submit\" class=\"btn btn-primary w-100\">\r\n            {{ loading ? 'Ingresando...' : 'Entrar' }}\r\n          </button>\r\n\r\n          <p v-if=\"errorMessage\" class=\"text-danger mt-3 mb-0\">{{ errorMessage }}</p>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport http from \"@/api/http\";\r\n\r\nexport default {\r\n  name: \"LoginView\",\r\n  data() {\r\n    return {\r\n      username: \"\",\r\n      password: \"\",\r\n      errorMessage: \"\",\r\n      loading: false,\r\n      showPass: false,\r\n    };\r\n  },\r\n  mounted() {\r\n    // Si ya hay token, redirige a la app\r\n    const token = localStorage.getItem(\"access_token\");\r\n    if (token) this.$router.replace(\"/categorias\");\r\n  },\r\n  methods: {\r\n    async handleLogin() {\r\n      this.errorMessage = \"\";\r\n      if (!this.username || !this.password) {\r\n        this.errorMessage = \"Ingrese usuario y contraseña\";\r\n        return;\r\n      }\r\n\r\n      this.loading = true;\r\n      try {\r\n        // /auth/login devuelve access en JSON y setea refresh en cookie HTTPOnly\r\n        const { data } = await http.post(\"/auth/login\", {\r\n          username: this.username,\r\n          password: this.password,\r\n        });\r\n\r\n        // Guardar access token y (opcional) username para mostrar en navbar\r\n        localStorage.setItem(\"access_token\", data.access_token);\r\n        if (data?.user?.username) localStorage.setItem(\"username\", data.user.username);\r\n\r\n        // Ir al dashboard (ajusta la ruta si necesitas)\r\n        this.$router.push(\"/categorias\");\r\n      } catch (e) {\r\n        this.errorMessage = e?.response?.data?.error || \"Usuario o contraseña incorrectos\";\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n"],"mappings":";AAmDA,OAAOA,IAAG,MAAO,YAAY;AAE7B,eAAe;EACbC,IAAI,EAAE,WAAW;EACjBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,EAAE;MACZC,YAAY,EAAE,EAAE;MAChBC,OAAO,EAAE,KAAK;MACdC,QAAQ,EAAE;IACZ,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR;IACA,MAAMC,KAAI,GAAIC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;IAClD,IAAIF,KAAK,EAAE,IAAI,CAACG,OAAO,CAACC,OAAO,CAAC,aAAa,CAAC;EAChD,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,WAAWA,CAAA,EAAG;MAClB,IAAI,CAACV,YAAW,GAAI,EAAE;MACtB,IAAI,CAAC,IAAI,CAACF,QAAO,IAAK,CAAC,IAAI,CAACC,QAAQ,EAAE;QACpC,IAAI,CAACC,YAAW,GAAI,8BAA8B;QAClD;MACF;MAEA,IAAI,CAACC,OAAM,GAAI,IAAI;MACnB,IAAI;QACF;QACA,MAAM;UAAEJ;QAAK,IAAI,MAAMF,IAAI,CAACgB,IAAI,CAAC,aAAa,EAAE;UAC9Cb,QAAQ,EAAE,IAAI,CAACA,QAAQ;UACvBC,QAAQ,EAAE,IAAI,CAACA;QACjB,CAAC,CAAC;;QAEF;QACAM,YAAY,CAACO,OAAO,CAAC,cAAc,EAAEf,IAAI,CAACgB,YAAY,CAAC;QACvD,IAAIhB,IAAI,EAAEiB,IAAI,EAAEhB,QAAQ,EAAEO,YAAY,CAACO,OAAO,CAAC,UAAU,EAAEf,IAAI,CAACiB,IAAI,CAAChB,QAAQ,CAAC;;QAE9E;QACA,IAAI,CAACS,OAAO,CAACQ,IAAI,CAAC,aAAa,CAAC;MAClC,EAAE,OAAOC,CAAC,EAAE;QACV,IAAI,CAAChB,YAAW,GAAIgB,CAAC,EAAEC,QAAQ,EAAEpB,IAAI,EAAEqB,KAAI,IAAK,kCAAkC;MACpF,UAAU;QACR,IAAI,CAACjB,OAAM,GAAI,KAAK;MACtB;IACF;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}